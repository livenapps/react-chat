(this.webpackJsonpchat=this.webpackJsonpchat||[]).push([[0],{38:function(e,t,a){e.exports=a(73)},43:function(e,t,a){},70:function(e,t){},73:function(e,t,a){"use strict";a.r(t);var s=a(0),n=a.n(s),o=a(30),c=a.n(o),r=a(35),i=a(31),u=a(32),l=a(36),m=a(33),h=a(2),d=a(37),g=(a(43),a(34)),v=a.n(g),f={URL:"https://ws-server-chat.herokuapp.com"},p=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(m.a)(t).call(this,e))).state={usersCount:0,userName:localStorage.getItem("userName")||"",userId:"",userMessage:"",messages:[],users:new Map},a.socket=v()(f.URL),a.subscribeOnSocketEvents(),a.onLeaveWindow(),a.setUserName=a.setUserName.bind(Object(h.a)(a)),a.setUserMessage=a.setUserMessage.bind(Object(h.a)(a)),a.sendUserMessage=a.sendUserMessage.bind(Object(h.a)(a)),a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"setUserName",value:function(e){this.setState({userName:e.target.value})}},{key:"setUserMessage",value:function(e){this.setState({userMessage:e.target.value})}},{key:"subscribeOnSocketEvents",value:function(){var e=this;this.socket.on("connect",(function(){console.warn("You are connected")})),this.socket.on("reconnect",(function(){console.warn("You are reconnected")})),this.socket.on("disconnect",(function(){console.log("You are disconnected")})),this.socket.on("event",(function(e){console.log(e)})),this.socket.on("message",(function(t){"sent"===t.event||"received"===t.event?e.setState({messages:[].concat(Object(r.a)(e.state.messages),[t.data])}):"connected"===t.event?(console.log("connected",t.data),e.setState({userId:t.data.userId,usersCount:t.data.usersCount})):"userJoined"===t.event?(console.log("userJoined",t.data),e.setState({usersCount:t.data.usersCount})):"userLeft"===t.event&&e.setState({usersCount:t.data.usersCount})}))}},{key:"sendUserMessage",value:function(e){e.preventDefault(),this.state.userMessage&&this.socket.send({name:this.state.userName,message:this.state.userMessage})}},{key:"onLeaveWindow",value:function(){var e=this;window.addEventListener("beforeunload",(function(){localStorage.setItem("userName",e.state.userName)}))}},{key:"render",value:function(){return n.a.createElement(n.a.Fragment,null,n.a.createElement("header",{className:"chat__header"},n.a.createElement("h1",{className:"chat__title"},"socket.io / context api + hooks / jest / typescript"),n.a.createElement("h2",{className:"chat__subtitle"},"Hello, ".concat(this.state.userName)),n.a.createElement("h2",{className:"chat__subtitle"},"Now in chat ".concat(this.state.usersCount," people"))),n.a.createElement("div",{className:"chat__main-wrapper"},n.a.createElement("aside",{className:"chat__sidebar"},n.a.createElement("fieldset",{className:"chat__fieldset"},n.a.createElement("legend",{className:"chat__legend"},"Insert/change your name:"),n.a.createElement("input",{className:"chat__input chat__input--name",type:"text",value:this.state.userName,onChange:this.setUserName}))),n.a.createElement("section",{className:"chat__messages"},n.a.createElement("div",{className:"chat__messages-wrapper"},this.state.messages.map((function(e,t){var a=new Date(e.date);return n.a.createElement("article",{key:t,className:"chat__message message"},n.a.createElement("header",{className:"message__header"},n.a.createElement("span",{className:"message__author"},e.name),n.a.createElement("time",{className:"message__time"},"".concat(a.getHours(),":").concat(a.getMinutes(),":").concat(a.getSeconds()))),n.a.createElement("main",{className:"message__content"},e.message))}))))),n.a.createElement("form",{className:"chat__input-area input-area",onSubmit:this.sendUserMessage},n.a.createElement("textarea",{className:"input-area__text-input",name:"input-area",id:"input-area",rows:"3",value:this.state.userMessage,onChange:this.setUserMessage}),n.a.createElement("button",{className:"input-area__btn",type:"submit"},"Send")))}}]),t}(n.a.Component),_=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function w(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}c.a.render(n.a.createElement(p,null),document.getElementById("chat")),function(e){if("serviceWorker"in navigator){if(new URL("/react-chat",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/react-chat","/service-worker.js");_?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(a){var s=a.headers.get("content-type");404===a.status||null!=s&&-1===s.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):w(e,t)})).catch((function(){console.log("No internet connection found. Index is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):w(t,e)}))}}()}},[[38,1,2]]]);
//# sourceMappingURL=main.89a198eb.chunk.js.map